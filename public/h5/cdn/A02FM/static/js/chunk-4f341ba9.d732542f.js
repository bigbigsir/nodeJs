(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f341ba9"],{"285b":function(t,e,i){},dd5f:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("div",{staticClass:"dew-figure-container"},[i("div",{staticClass:"dew-figure-header clearfix"},[i("span",{staticClass:"game-table"},[t._v(t._s(t.vid)+"桌")]),i("span",{staticClass:"timer-text"},[i("i",{staticClass:"icon-time"}),i("span",{staticClass:"monospaced-font"},[t._v(" 00"),i("span",[t._v(":")]),t._v(t._s(t.countdown>9?t.countdown:"0"+t.countdown)+" ")])])]),i("div",{staticClass:"scoreboard clearfix"},[i("span",{staticClass:"scoreboard-item"},[i("span",[t._v("庄")]),i("span",[t._v(t._s(t.banker))])]),i("span",{staticClass:"scoreboard-item"},[i("span",[t._v("和")]),i("span",[t._v(t._s(t.tie))])]),i("span",{staticClass:"scoreboard-item"},[i("span",[t._v("闲")]),i("span",[t._v(t._s(t.player))])])]),i("div",{staticClass:"canvas-container"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showShuffle,expression:"showShuffle"}],staticClass:"shuffle-wrapper"},[i("span",{staticClass:"shuffle-text"},[t._v("洗牌中")])]),t.showLoading?i("div",{staticClass:"loading-wrapper"},[i("span",{staticClass:"loading-text"},[t._v("loading...")])]):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.showShuffle,expression:"!showShuffle"}],staticClass:"canvas-wrapper",attrs:{id:"canvasWrapper1"}},[i("canvas",{attrs:{id:"canvas1"}})])]),i("div",{staticClass:"button-wrapper"},[i("button",{staticClass:"submit-button",on:{click:function(){return null}}},[i("span",{staticClass:"button-text"},[t._v("快速入座")])])])])])},r=[],s=i("5880"),o=i("a48d"),a=i.n(o),l=i("a078"),c=i.n(l);function u(t){return p(t)||f(t)||d(t)||h()}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(t,e){if(t){if("string"===typeof t)return w(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?w(t,e):void 0}}function f(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function p(t){if(Array.isArray(t))return w(t)}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function v(t){return v="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function g(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function m(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?g(Object(i),!0).forEach((function(e){b(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function b(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var y={name:"dewFigure",data:function(){return{ctx:null,vid:"D052",columns:16,rows:6,cellSizeWidth:23,cellSizeHeight:23,lineWidth:1,resultColor:{banker:"#d55263",player:"#6e8df7",tie:"#4ea950"},showLoading:!0,showShuffle:!0,resultList:[],timer:null,countdown:0,timerText:null,lastGameCode:null}},computed:m(m({},Object(s["mapState"])(["socketResultList"])),{},{origin:function(){return this.lineWidth/2},cellHeight:function(){return this.cellSizeHeight+this.lineWidth},cellWidth:function(){return this.cellSizeWidth+this.lineWidth},gridWidth:function(){return this.lineWidth+this.columns*this.cellWidth},gridHeight:function(){return this.lineWidth+this.rows*this.cellHeight},banker:function(){return this.resultList.filter((function(t){return"banker"===t.result})).length},player:function(){return this.resultList.filter((function(t){return"player"===t.result})).length},tie:function(){return this.resultList.filter((function(t){return"tie"===t.result})).length}}),created:function(){var t=this,e=a()(c.a.socketUrl);e.on("result list",(function(e){t.formatResultList(JSON.parse(e))})),e.on("close round",(function(e){e=JSON.parse(e),e.vid===t.vid&&t.lastGameCode!==e.gmcode&&(t.closeRound(e),console.log("close round:\n",e))})),e.on("new round",(function(e){e=JSON.parse(e),e.vid===t.vid&&(t.newRound(e.seconds),console.log("new round:\n",e))})),e.on("new shoes",(function(e){e=JSON.parse(e),e.vid===t.vid&&(t.newShoes(),console.log("new shoes:\n",e))})),this.socket=e},mounted:function(){var t=document.getElementById("canvas1"),e=document.getElementById("canvasWrapper1"),i=t.getContext("2d"),n=window.devicePixelRatio;n&&(n=Math.ceil(n),n=n>2?n:4,t.width=this.gridWidth*n,t.height=this.gridHeight*n,t.style.width=this.gridWidth+"px",t.style.height=this.gridHeight+"px",e.style.width=this.gridWidth+"px",e.style.height=this.gridHeight+"px",i.scale(n,n)),this.ctx=i},destroyed:function(){this.socket.destroy()},methods:{drawGrid:function(t){for(var e="#202020",i=this.origin;i<=this.gridWidth;i+=this.cellWidth)t.beginPath(),t.strokeStyle=e,t.lineWidth=this.lineWidth,t.moveTo(i,0),t.lineTo(i,this.gridHeight),t.stroke();for(var n=this.origin;n<=this.gridHeight;n+=this.cellHeight)t.beginPath(),t.strokeStyle=e,t.lineWidth=this.lineWidth,t.moveTo(0,n),t.lineTo(this.gridWidth,n),t.stroke()},drawCircle:function(t,e,i,n){var r="#141414",s=n,o=3,a=8;t.beginPath(),t.arc(e,i,a,0,360,!1),t.fillStyle=r,t.strokeStyle=s,t.lineWidth=o,t.fill(),t.stroke()},drawLine:function(t,e,i,n,r){t.beginPath(),t.moveTo(e[0],e[1]),t.lineTo(i[0],i[1]),t.lineWidth=n,t.strokeStyle=r,t.stroke()},drawText:function(t,e,i,n,r){t.beginPath(),t.font=r,t.fillStyle="#fff",t.textAlign="center",t.textBaseline="middle",t.fillText(n,e,i),t.stroke()},drawDewFigure:function(t){var e=this,i=this.formatBigRoadData(this.resultList).slice(-(this.columns-1));t.clearRect(0,0,this.gridWidth,this.gridHeight),this.drawGrid(t),i.forEach((function(i,n){i.forEach((function(i,r){var s=(n+1)*e.cellWidth-e.cellSizeWidth/2,o=(r+1)*e.cellHeight-e.cellSizeHeight/2;if(i.color&&e.drawCircle(t,s,o,i.color),i.tieNumber){var a=3,l=n*e.cellWidth+e.origin,c=r*e.cellHeight+e.origin;e.drawLine(t,[l+a,c+e.cellHeight-a],[l+e.cellWidth-a,c+a],2,e.resultColor.tie),i.tieNumber>1&&i.tieNumber<10?e.drawText(t,Math.ceil(s),Math.ceil(o),"2","16px Calibri"):i.tieNumber>10&&e.drawText(t,s,Math.ceil(o),"18","12px Calibri")}}))})),t.closePath()},formatItemData:function(t){var e={pair:t.pair};return t.banker_val>t.player_val?e.result="banker":t.banker_val<t.player_val?e.result="player":e.result="tie",e},formatBigRoadData:function(){var t,e,i,n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=0,o=!1,a=[];function l(t,e){if(e)if(t.result!==i)o=!0;else{if("object"===v(o))return o;o={isAddColumn:!0,addIndex:this.rows-1};for(var n=0;n<this.rows;n++){if(!e[n]){o=!1;break}if(e[n].isNewColumn){o={isAddColumn:!0,addIndex:n-1};break}}}else o=!0;return o}function c(e){var i=l.call(this,e,t);if(i){var n,r;if(void 0!==i.addIndex){var s;for(e.isNewColumn=!0,s=a.length;s--;)if(t===a[s])break;r=a[s+1],r&&(t=r)}else n=a.some((function(e){if(!e[0])return t=e}));n||r||(t=[],a.push(t))}for(var o=0;o<this.rows;o++){if(void 0!==i.addIndex)return t[i.addIndex]=e;if(!t[o])return t[o]=e}console.error("游戏结局添加到列中失败")}return(r.forEach((function(t){"tie"===t.result?e?(s=0,e.tieNumber+=1):s+=1:(e=m(m({},t),{},{tieNumber:s,color:n.resultColor[t.result]}),c.call(n,e),s=0,i=t.result)})),s&&!a.length&&a.push([m(m({},r[0]),{},{tieNumber:s})]),a)},countdownFunc:function(t){var e=this;this.timerText=null,clearInterval(this.timer),0===this.countdown&&(this.timerText=t),this.timer=setInterval((function(){e.countdown>0?e.countdown--:(e.timerText=t,clearInterval(e.timer))}),1e3)},newShoes:function(){this.countdown=0,this.countdownFunc("洗牌中"),this.showShuffle=!0,this.resultList=[],this.drawDewFigure(this.ctx)},newRound:function(t){this.showShuffle=!1,this.countdown=t,this.countdownFunc("结算中")},closeRound:function(t){this.countdown=0,this.countdownFunc("发牌中"),this.resultList=[].concat(u(this.resultList),[this.formatItemData(t)]),this.drawDewFigure(this.ctx)},formatResultList:function(t){if(t=t[this.vid],t){var e,i,n=t.roundRes||{},r=[];for(e in n)n.hasOwnProperty(e)&&(i=this.formatItemData(n[e]),r.push(i));r.length?(this.resultList=r,this.newRound(t.seconds),this.drawDewFigure(this.ctx)):this.newShoes(),this.showLoading=!1}}}},S=y,x=(i("e8f5"),i("2877")),C=Object(x["a"])(S,n,r,!1,null,"48f954aa",null);e["default"]=C.exports},e8f5:function(t,e,i){"use strict";var n=i("285b"),r=i.n(n);r.a}}]);