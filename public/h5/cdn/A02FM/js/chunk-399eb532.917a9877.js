"use strict";(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-399eb532"],{"1a3d":function(t,i,e){var s=e("51c7");e.n(s).a},"51c7":function(){},dd5f:function(t,i,e){e.r(i);var s=(e("99af"),e("cb29"),e("4de4"),e("4160"),e("fb6a"),e("45fc"),e("159b"),e("2909")),h=e("53ca"),r=e("5530"),n=e("5880"),a={name:"dewFigure",data:function(){return{ctx:null,vid:"D052",columns:16,rows:6,cellSizeWidth:23,cellSizeHeight:23,lineWidth:1,resultColor:{banker:"#d55263",player:"#6e8df7",tie:"#4ea950"},showLoading:!0,showShuffle:!0,resultList:[],timer:null,countdown:0,timerText:null,lastGameCode:null}},computed:Object(r.a)({},Object(n.mapState)(["socketResultList"]),{origin:function(){return this.lineWidth/2},cellHeight:function(){return this.cellSizeHeight+this.lineWidth},cellWidth:function(){return this.cellSizeWidth+this.lineWidth},gridWidth:function(){return this.lineWidth+this.columns*this.cellWidth},gridHeight:function(){return this.lineWidth+this.rows*this.cellHeight},banker:function(){return this.resultList.filter(function(t){return"banker"===t.result}).length},player:function(){return this.resultList.filter(function(t){return"player"===t.result}).length},tie:function(){return this.resultList.filter(function(t){return"tie"===t.result}).length}}),mounted:function(){var t=document.getElementById("canvas1"),i=document.getElementById("canvasWrapper1"),e=t.getContext("2d"),s=window.devicePixelRatio;s&&(s=2<(s=Math.ceil(s))?s:4,t.width=this.gridWidth*s,t.height=this.gridHeight*s,t.style.width=this.gridWidth+"px",t.style.height=this.gridHeight+"px",i.style.width=this.gridWidth+"px",i.style.height=this.gridHeight+"px",e.scale(s,s)),this.ctx=e,this.formatResultList(this.socketResultList)},methods:{drawGrid:function(t){for(var i="#202020",e=this.origin;e<=this.gridWidth;e+=this.cellWidth)t.beginPath(),t.strokeStyle=i,t.lineWidth=this.lineWidth,t.moveTo(e,0),t.lineTo(e,this.gridHeight),t.stroke();for(var s=this.origin;s<=this.gridHeight;s+=this.cellHeight)t.beginPath(),t.strokeStyle=i,t.lineWidth=this.lineWidth,t.moveTo(0,s),t.lineTo(this.gridWidth,s),t.stroke()},drawCircle:function(t,i,e,s){var n=s;t.beginPath(),t.arc(i,e,8,0,360,!1),t.fillStyle="#141414",t.strokeStyle=n,t.lineWidth=3,t.fill(),t.stroke()},drawLine:function(t,i,e,s,n){t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(e[0],e[1]),t.lineWidth=s,t.strokeStyle=n,t.stroke()},drawText:function(t,i,e,s,n){t.beginPath(),t.font=n,t.fillStyle="#fff",t.textAlign="center",t.textBaseline="middle",t.fillText(s,i,e),t.stroke()},drawDewFigure:function(o){var l=this,t=this.formatBigRoadData(this.resultList).slice(-(this.columns-1));o.clearRect(0,0,this.gridWidth,this.gridHeight),this.drawGrid(o),t.forEach(function(t,a){t.forEach(function(t,i){var e=(a+1)*l.cellWidth-l.cellSizeWidth/2,s=(i+1)*l.cellHeight-l.cellSizeHeight/2;if(l.drawCircle(o,e,s,t.color),t.tieNumber){var n=a*l.cellWidth+l.origin,r=i*l.cellHeight+l.origin;l.drawLine(o,[n+3,r+l.cellHeight-3],[n+l.cellWidth-3,r+3],2,l.resultColor.tie),1<t.tieNumber&&t.tieNumber<10?l.drawText(o,Math.ceil(e),Math.ceil(s),"2","16px Calibri"):10<t.tieNumber&&l.drawText(o,e,Math.ceil(s),"18","12px Calibri")}})}),o.closePath()},formatItemData:function(t){var i={pair:t.pair};return t.banker_val>t.player_val?i.result="banker":t.banker_val<t.player_val?i.result="player":i.result="tie",i},formatBigRoadData:function(t){var a,i,o,e=this,s=0,l=!1,c=[];function n(t){var i=function(t,i){if(i)if(t.result!==o)l=!0;else{if("object"===Object(h.a)(l))return l;l=!0;for(var e=0;e<this.rows;e++){if(!i[e]){l=!1;break}if(i[e].isNewColumn){l={isAddColumn:!0,addIndex:e-1};break}}!0===l&&(l={isAddColumn:!0,addIndex:this.rows-1})}else l=!0;return l}.call(this,t,a);if(i){var e,s;if(void 0!==i.addIndex){var n;for(t.isNewColumn=!0,n=c.length;n--&&a!==c[n];);(s=c[n+1])&&(a=s)}else e=c.some(function(t){if(!t[0])return a=t});e||s||(a=[],c.push(a))}for(var r=0;r<this.rows;r++){if(void 0!==i.addIndex)return a[i.addIndex]=t;if(!a[r])return a[r]=t}}return(0<arguments.length&&void 0!==t?t:[]).forEach(function(t){"tie"===t.result?i?(s=0,i.tieNumber+=1):s+=1:(i=Object(r.a)({},t,{tieNumber:s,color:e.resultColor[t.result]}),n.call(e,i),s=0,o=t.result)}),c},countdownFunc:function(t){var i=this;this.timerText=null,clearInterval(this.timer),0===this.countdown&&(this.timerText=t),this.timer=setInterval(function(){0<i.countdown?i.countdown--:(i.timerText=t,clearInterval(i.timer))},1e3)},newShoes:function(){this.countdown=0,this.countdownFunc("洗牌中"),this.showShuffle=!0,this.resultList=[],this.drawDewFigure(this.ctx)},newRound:function(t){this.showShuffle=!1,this.countdown=t,this.countdownFunc("结算中")},closeRound:function(t){this.countdown=0,this.countdownFunc("发牌中"),this.resultList=[].concat(Object(s.a)(this.resultList),[this.formatItemData(t)]),this.drawDewFigure(this.ctx)},formatResultList:function(t){var i,e,s=(t=t[this.vid]||{}).roundRes||{},n=[];for(i in s)s.hasOwnProperty(i)&&(e=this.formatItemData(s[i]),n.push(e));n.length?(this.resultList=n,this.newRound(t.seconds),this.drawDewFigure(this.ctx)):this.newShoes(),this.showLoading=!1}},sockets:{connect_error:function(){},connect_timeout:function(){},reconnect_error:function(){},reconnect_failed:function(){},"result list":function(t){this.formatResultList(JSON.parse(t))},"new shoes":function(t){(t=JSON.parse(t)).vid===this.vid&&this.newShoes()},"new round":function(t){(t=JSON.parse(t)).vid===this.vid&&this.newRound(t.seconds)},"close round":function(t){(t=JSON.parse(t)).vid===this.vid&&this.lastGameCode!==t.gmcode&&this.closeRound(t)}}},o=(e("1a3d"),e("2877")),l=Object(o.a)(a,function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"container"},[e("div",{staticClass:"dew-figure-container"},[e("div",{staticClass:"dew-figure-header clearfix"},[e("span",{staticClass:"game-table"},[t._v(t._s(t.vid)+"桌")]),e("span",{staticClass:"timer-text"},[e("i",{staticClass:"icon-time"}),e("span",{staticClass:"monospaced-font"},[t._v(" 00"),e("span",[t._v(":")]),t._v(t._s(9<t.countdown?t.countdown:"0"+t.countdown)+" ")])])]),e("div",{staticClass:"scoreboard clearfix"},[e("span",{staticClass:"scoreboard-item"},[e("span",[t._v("庄")]),e("span",[t._v(t._s(t.banker))])]),e("span",{staticClass:"scoreboard-item"},[e("span",[t._v("和")]),e("span",[t._v(t._s(t.tie))])]),e("span",{staticClass:"scoreboard-item"},[e("span",[t._v("闲")]),e("span",[t._v(t._s(t.player))])])]),e("div",{staticClass:"canvas-container"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showShuffle,expression:"showShuffle"}],staticClass:"shuffle-wrapper"},[e("span",{staticClass:"shuffle-text"},[t._v("洗牌中")])]),t.showLoading?e("div",{staticClass:"loading-wrapper"},[e("span",{staticClass:"loading-text"},[t._v("loading...")])]):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showShuffle,expression:"!showShuffle"}],staticClass:"canvas-wrapper",attrs:{id:"canvasWrapper1"}},[e("canvas",{attrs:{id:"canvas1"}})])]),e("div",{staticClass:"button-wrapper"},[e("button",{staticClass:"submit-button",on:{click:function(){return null}}},[e("span",{staticClass:"button-text"},[t._v("快速入座")])])])])])},[],!1,null,"7460f894",null);i.default=l.exports}}]);