{"version":3,"sources":["components/loading/Rotate.js","assets/img/common/rotate.png","views/promotions/promotions.module.scss","views/promotions/img/icon_more.png","views/promotions/promotions.js"],"names":["cx","classNames","bind","scss","Rotate","className","src","require","alt","module","exports","Promotions","menu","name","useState","overdue","setOverdue","promoList","setPromoList","effective","setEffective","activeIndex","setActiveIndex","showOverdue","setShowOverdue","useEffect","params","_","getUUId","_useWebpImg","useWebpImg","wms","window","OMConfig","wmsServer","getWmsStatic","then","status","data","Array","isArray","map","item","is_blank","link","imgUrl","pic","imgLazyInit","key","length","forEach","label","flag","beginTime","time_begin","endTime","time_end","nowTime","Date","now","timer","restOfTime","days","Math","floor","hours","minutes","getRestOfDate","filterPromoItem","push","index","onClick","toString","active","id","title","data-src","describe","remark","open"],"mappings":"oGAAA,uFAIMA,EAAKC,IAAWC,KAAKC,KAEZ,SAASC,IACtB,OACE,yBAAKC,UAAWL,EAAG,WACjB,yBAAKK,UAAWL,EAAG,eAAgBM,IAAKC,EAAQ,KAAmCC,IAAI,Q,kBCT7FC,EAAOC,QAAU,oE,oBCCjBD,EAAOC,QAAU,CAAC,MAAQ,YAAY,eAAiB,YAAY,YAAc,YAAY,oBAAoB,YAAY,YAAc,YAAY,oBAAoB,YAAY,aAAe,YAAY,qBAAqB,YAAY,YAAc,YAAY,cAAgB,YAAY,WAAa,YAAY,QAAU,YAAY,YAAc,YAAY,aAAe,YAAY,gBAAkB,YAAY,cAAgB,YAAY,YAAc,YAAY,mBAAmB,YAAY,KAAO,YAAY,KAAO,YAAY,YAAc,YAAY,WAAa,YAAY,WAAa,YAAY,SAAS,YAAY,SAAS,YAAY,SAAS,YAAY,SAAS,YAAY,SAAS,YAAY,SAAS,YAAY,SAAS,YAAY,SAAS,YAAY,OAAS,YAAY,WAAa,YAAY,eAAe,c,kBCDv1BD,EAAOC,QAAU,06D,oICOXV,EAAKC,IAAWC,KAAKC,KA2MZQ,UAzMf,WACE,IAAMC,EAAO,CACX,CACEC,KAAM,4BAER,CACEA,KAAM,kCAER,CACEA,KAAM,4BAER,CACEA,KAAM,4BAER,CACEA,KAAM,4BAER,CACEA,KAAM,4BAER,CACEA,KAAM,6BArBU,EAwBUC,mBAAS,IAxBnB,mBAwBbC,EAxBa,KAwBJC,EAxBI,OAyBcF,mBAAS,IAzBvB,mBAyBbG,EAzBa,KAyBFC,EAzBE,OA0BcJ,mBAAS,IA1BvB,mBA0BbK,EA1Ba,KA0BFC,EA1BE,OA2BkBN,mBAAS,GA3B3B,mBA2BbO,EA3Ba,KA2BAC,EA3BA,OA4BkBR,oBAAS,GA5B3B,mBA4BbS,EA5Ba,KA4BAC,EA5BA,KAmHpB,OArFAC,qBAIA,WACE,IAAMC,EAAS,CACbA,OAAQ,CACNC,EAAGC,gBAGDC,EAAcC,IAEdC,EAAMC,OAAOC,SAASC,UAAY,IACxCC,YAFY,oBAEMT,GAAQU,MAAK,YAAuB,IAApBC,EAAmB,EAAnBA,OAAQC,EAAW,EAAXA,KAEzB,MAAXD,GAAkBE,MAAMC,QAAQF,KAClCA,EAAOA,EAAKG,KAAI,SAAAC,GAOd,OANK,eACAA,EADA,CAEHC,SAA6B,KAAlBD,EAAKC,SAChBC,KAAMF,EAAKE,KAAL,cAAmBF,EAAKE,MAAS,KACvCC,OAAQd,EAAMW,EAAKI,IAAMjB,EAAY,UAIzCX,EAAaoB,SAzBK,IACxBb,oBAAUsB,IAAa,CAAChC,EAASI,EAAWI,IAC5CE,qBA4BA,WACE,IAAMuB,EAAMpC,EAAKS,GACXN,EAAU,GACVI,EAAY,GAClB,GAAIE,GAAeT,EAAKqC,OAAQ,OAChChC,EAAUiC,SAAQ,SAAAR,GACZrB,GAAeqB,EAAKS,QAAUH,EAAInC,QAY1C,SAAyB6B,GACvB,IAAIU,GAAO,EACLC,GAAaX,EAAKY,WAClBC,GAAWb,EAAKc,SAChBC,EAAUC,KAAKC,MAAQ,IACzBN,GAAaE,EACfH,EAAOK,EAAUJ,GAAaI,EAAUF,EAC/BF,EACTD,EAAOK,EAAUJ,EACRE,IACTH,EAAOK,EAAUF,GAGnB,OADAb,EAAKkB,MAIP,SAAuBH,EAASF,GAC9B,IAAIK,EAGEC,EAAaN,EAAUE,EAC7B,GAAIF,EACF,GAAIM,GAAc,EAAG,CACnB,IAAMC,EAAOC,KAAKC,MAAMH,EAJb,OAKLI,EAAQF,KAAKC,MAAMH,EALd,MADC,MAONK,EAAUH,KAAKC,MAAMH,EANhB,MADC,KAO+C,IAC3DD,EAAK,wCAAWE,EAAX,mBAAqBG,EAArB,mBAAgCC,EAAhC,gBAELN,EAAQ,gCAGVA,EAAQ,uCAGV,OAAOA,EAtBMO,CAAcV,EAASF,GAC7BH,EAxBDgB,CAAgB1B,GAGlB3B,EAAQsD,KAAK3B,GAFbvB,EAAUkD,KAAK3B,OAKnBlB,IAAiBH,GACjBL,EAAWD,GACXK,EAAaD,KA3CY,CAACE,EAAaJ,IAoFvC,yBAAKZ,UAAWL,EAAG,UACjB,yBAAKK,UAAWL,EAAG,mBACjB,yBAAKK,UAAWL,EAAG,SACjB,uBAAGK,UAAWL,EAAG,gBAAjB,4BACA,wBAAIK,UAAWL,EAAG,eAEdY,EAAK6B,KAAI,SAACC,EAAM4B,GAAP,OACP,wBAAIC,QAAS,kBAAMjD,EAAegD,IAAQtB,IAAKsB,EAAME,WACnDnE,UAAWL,EAAG,aAAc,CAAEyE,OAAQpD,IAAgBiD,KACtD,uBAAGjE,UAAWL,EAAG,aAAc,QAAUsE,KACzC,8BAAO5B,EAAK7B,MACZ,0BAAMR,UAAWL,EAAG,qBAI1B,wBAAIuE,QAAS,kBAAMjD,EAAe,IAChCjB,UAAWL,EAAG,aAAc,CAAEyE,OAAwB,IAAhBpD,KACtC,uBAAGhB,UAAWL,EAAG,aAAc,YAC/B,gEACA,0BAAMK,UAAWL,EAAG,oBAI1B,yBAAKK,UAAWL,EAAG,gBACjB,wBAAIK,UAAWL,EAAG,sBAEdmB,EAAUsB,KAAI,SAAAC,GAAI,OAChB,wBAAIM,IAAKN,EAAKgC,GAAIrE,UAAWL,EAAG,gBAC9B,uBAAGK,UAAWL,EAAG,iBAAkB0C,EAAKiC,OACxC,yBAAKtE,UAAWL,EAAG,sBACjB,yBAAKK,UAAWL,EAAG,qBAAsB,oBACvC,yBAAKK,UAAWL,EAAG,cAAe4E,WAAUlC,EAAKG,OAAQrC,IAAI,KAC7D,yBAAKH,UAAWL,EAAG,gBACjB,4BAAQK,UAAWL,EAAG,kBAAtB,8BAGJ,yBAAKK,UAAWL,EAAG,gBACjB,0BAAMK,UAAWL,EAAG,iBAAkB0C,EAAKkB,OAC3C,uBAAGvD,UAAWL,EAAG,oBAAqB0C,EAAKmC,UAC3C,uBAAGxE,UAAWL,EAAG,kBAAjB,iCACQ0C,EAAKoC,cAQL,IAAhBzD,KAAuBN,EAAQkC,QAC/B,wBAAIsB,QAAS,kBAAM/C,GAAgBD,IACjClB,UAAWL,EAAG,cAAe,gBAC7B,yBAAKK,UAAWL,EAAG,mBAAoB,CAAE+E,KAAMxD,IAC7CjB,IAAKC,EAAQ,KAAyCC,IAAI,KAC5D,2DAIFe,EAAcR,EAAQ0B,KAAI,SAAAC,GAAI,OAC5B,wBAAIM,IAAKN,EAAKgC,GAAIrE,UAAWL,EAAG,gBAC9B,uBAAGK,UAAWL,EAAG,iBAAkB0C,EAAKiC,OACxC,yBAAKtE,UAAWL,EAAG,sBACjB,yBAAKK,UAAWL,EAAG,qBAAsB,oBACvC,yBAAKK,UAAWL,EAAG,aAAc,WAAY4E,WAAUlC,EAAKG,OAAQrC,IAAI,MAE1E,yBAAKH,UAAWL,EAAG,gBACjB,0BAAMK,UAAWL,EAAG,eAAgB,YAAa0C,EAAKkB,OACtD,uBAAGvD,UAAWL,EAAG,oBAAqB0C,EAAKmC,UAC3C,uBAAGxE,UAAWL,EAAG,kBAAjB,iCACQ0C,EAAKoC,cAKhB,MAIP3D,EAAU8B,QAAUlC,EAAQkC,OAAS,KAAO,kBAAC,IAAD","file":"cdn/A02F/static/js/8.7b6eba2e.chunk.js","sourcesContent":["import React from 'react'\nimport classNames from 'classnames/bind'\nimport scss from './loading.module.scss'\n\nconst cx = classNames.bind(scss)\n\nexport default function Rotate() {\n  return (\n    <div className={cx('rotate')}>\n      <img className={cx('rotate__img')} src={require('@/assets/img/common/rotate.png')} alt=\"\"/>\n    </div>\n  )\n}\n","module.exports = \"https://img.60kg.top/web/cdn/A02F/static/img/rotate.9636734b.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"promo\":\"css-3JRns\",\"promo__content\":\"css-3K-ne\",\"promo__list\":\"css-38Nf9\",\"promo__list-inner\":\"css-1Lw-b\",\"promo__item\":\"css-Ny3gD\",\"promo__item-inner\":\"css-34SxP\",\"promo__title\":\"css-2IV_l\",\"promo__img-wrapper\":\"css-2tFfc\",\"promo__mask\":\"css-1hbbt\",\"promo__button\":\"css-1Kxn4\",\"promo__img\":\"css-34Iv8\",\"overdue\":\"css-ODl5y\",\"promo__info\":\"css-1e6im\",\"promo__timer\":\"css-3cs7s\",\"promo__describe\":\"css-2YFCH\",\"promo__remark\":\"css-1W_ZM\",\"promo__more\":\"css-3vB9Y\",\"promo__icon-more\":\"css-1kkjb\",\"open\":\"css-1aEOx\",\"menu\":\"css-QSBCt\",\"menu__title\":\"css-1bVCE\",\"menu__list\":\"css-WTw_T\",\"menu__item\":\"css-3Qd7A\",\"icon-0\":\"css-2yTTW\",\"icon-1\":\"css-1PzQ9\",\"icon-2\":\"css-3i_pB\",\"icon-3\":\"css-1bqnP\",\"icon-4\":\"css-puNGD\",\"icon-5\":\"css-12nam\",\"icon-6\":\"css-1_Sa7\",\"icon-7\":\"css-28afq\",\"active\":\"css-3kCGg\",\"menu__icon\":\"css-1nJvW\",\"support-webp\":\"css-32Jmr\"};","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxMWZmNzA2NS04OWJmLTRjYjItODdmZS03ZTQ4YmFlOTBkNDAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MjhDRkJBOEIwODgyMTFFN0I3N0JCQzA3QThDRkY4MTYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MjhDRkJBOEEwODgyMTFFN0I3N0JCQzA3QThDRkY4MTYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1NmM4ZjY2MC03YjQ4LTRhNWMtOTU4Mi1iODZjNDE2ZmQxNWMiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDphMzkyZGM5Yy00OGVhLTExN2EtOGM1NS1lMDUzNjYzNDc2NWEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4mog7xAAABvElEQVR42pzU3ytkYRzH8TMotZGEJSMXW/IjZiOKkBLCDSUXJD/KX6DsXJgpNXe4ceNG+XHhwl5sfhTSljJIe7HFIElkW3ej1LaxK+X91Xd0Op2jmfnWq6k55/mc55zn+zwun89nOFQBhlGJD3jAT8zhLHJTIBB4G5BgE5KCLZyiD8+41t9ehBCE2zrQGtaMP0hDow5o0RC5lotaPOI3BpzC6rGNL6jBnsPrH2qwzHrB7/f3W8OSsAsvJo3oagmdWCTQbQ5bwy0mjNhqFZv6jV9nlIw2FBvxVQf+M7s8mdkQ7nAeTxKt8cTPBUYkrBXHNveN66yt5de+M9c+ShO0DX7ZDOrRNjHXpa72s+V/ebNECfuLHJuwQn31e2Ros2YhFf8s98p1l4TtoMLhk3hwgjDS9S3sqgFXEjarT3Q73FiHMeS/sw6fMO3SjR7Up3riWNCvMjNWNTvStO0ow2CMQdXoRlOkaQ1dNQnckA+J+SiCZP8eYJRZhawbXbZFl55X6yhyCJGVn9EgL0FThmmDm+ubLsYKjnCDH7pvM1Glh6acb5+tzW53OIZ1BWXQsvZVOT7iuwaW2O2aFwEGAI1yXtdefoq7AAAAAElFTkSuQmCC\"","import React, { useEffect, useState } from 'react'\nimport classNames from 'classnames/bind'\nimport Rotate from '@/components/loading/Rotate'\nimport { getWmsStatic } from '@/api/modules/wms'\nimport { getUUId, imgLazyInit, useWebpImg } from '@/utils/util'\nimport scss from './promotions.module.scss'\n\nconst cx = classNames.bind(scss)\n\nfunction Promotions() {\n  const menu = [\n    {\n      name: '全部优惠'\n    },\n    {\n      name: '新会员优惠'\n    },\n    {\n      name: '真人娱乐'\n    },\n    {\n      name: '体育投注'\n    },\n    {\n      name: '电子游艺'\n    },\n    {\n      name: '彩票投注'\n    },\n    {\n      name: '品牌活动'\n    }\n  ]\n  const [overdue, setOverdue] = useState([])\n  const [promoList, setPromoList] = useState([])\n  const [effective, setEffective] = useState([])\n  const [activeIndex, setActiveIndex] = useState(0)\n  const [showOverdue, setShowOverdue] = useState(false)\n\n  useEffect(getPromoList, [])\n  useEffect(imgLazyInit, [overdue, effective, showOverdue])\n  useEffect(filterPromoList, [activeIndex, promoList])\n\n  function getPromoList() {\n    const params = {\n      params: {\n        _: getUUId()\n      }\n    }\n    const _useWebpImg = useWebpImg\n    const url = '/_promo/promo.txt'\n    const wms = window.OMConfig.wmsServer + '/'\n    getWmsStatic(url, params).then(({ status, data }) => {\n      let promo\n      if (status === 200 && Array.isArray(data)) {\n        data = data.map(item => {\n          promo = {\n            ...item,\n            is_blank: +item.is_blank === 1,\n            link: item.link ? `/web${item.link}` : null,\n            imgUrl: wms + item.pic + _useWebpImg('_')\n          }\n          return promo\n        })\n        setPromoList(data)\n      }\n    })\n  }\n\n  function filterPromoList() {\n    const key = menu[activeIndex]\n    const overdue = []\n    const effective = []\n    if (activeIndex >= menu.length) return\n    promoList.forEach(item => {\n      if (activeIndex && item.label !== key.name) return\n      if (filterPromoItem(item)) {\n        effective.push(item)\n      } else {\n        overdue.push(item)\n      }\n    })\n    setShowOverdue(!!activeIndex)\n    setOverdue(overdue)\n    setEffective(effective)\n  }\n\n  function filterPromoItem(item) {\n    let flag = true\n    const beginTime = +item.time_begin\n    const endTime = +item.time_end\n    const nowTime = Date.now() / 1000\n    if (beginTime && endTime) {\n      flag = nowTime > beginTime && nowTime < endTime\n    } else if (beginTime) {\n      flag = nowTime > beginTime\n    } else if (endTime) {\n      flag = nowTime < endTime\n    }\n    item.timer = getRestOfDate(nowTime, endTime)\n    return flag\n  }\n\n  function getRestOfDate(nowTime, endTime) {\n    let timer\n    const oneHour = 60 * 60\n    const oneDay = 24 * oneHour\n    const restOfTime = endTime - nowTime\n    if (endTime) {\n      if (restOfTime >= 0) {\n        const days = Math.floor(restOfTime / oneDay)\n        const hours = Math.floor(restOfTime % oneDay / oneHour)\n        const minutes = Math.floor(restOfTime % oneDay % oneHour / 60)\n        timer = `剩余时间：${days} 天 ${hours} 时 ${minutes} 分`\n      } else {\n        timer = '活动结束'\n      }\n    } else {\n      timer = '活动长期有效'\n    }\n\n    return timer\n  }\n\n  return (\n    <div className={cx('promo')}>\n      <div className={cx('promo__content')}>\n        <div className={cx('menu')}>\n          <p className={cx('menu__title')}>优惠活动</p>\n          <ul className={cx('menu__list')}>\n            {\n              menu.map((item, index) => (\n                <li onClick={() => setActiveIndex(index)} key={index.toString()}\n                  className={cx('menu__item', { active: activeIndex === index })}>\n                  <i className={cx('menu__icon', 'icon-' + index)}/>\n                  <span>{item.name}</span>\n                  <span className={cx('menu__arrow')}/>\n                </li>\n              ))\n            }\n            <li onClick={() => setActiveIndex(7)}\n              className={cx('menu__item', { active: activeIndex === 7 })}>\n              <i className={cx('menu__icon', 'icon-7')}/>\n              <span>全民俱乐部</span>\n              <span className={cx('menu__arrow')}/>\n            </li>\n          </ul>\n        </div>\n        <div className={cx('promo__list')}>\n          <ul className={cx('promo__list-inner')}>\n            {\n              effective.map(item => (\n                <li key={item.id} className={cx('promo__item')}>\n                  <p className={cx('promo__title')}>{item.title}</p>\n                  <div className={cx('promo__item-inner')}>\n                    <div className={cx('promo__img-wrapper', 'default-bg-mini')}>\n                      <img className={cx('promo__img')} data-src={item.imgUrl} alt=\"\"/>\n                      <div className={cx('promo__mask')}>\n                        <button className={cx('promo__button')}>了解详情</button>\n                      </div>\n                    </div>\n                    <div className={cx('promo__info')}>\n                      <span className={cx('promo__timer')}>{item.timer}</span>\n                      <p className={cx('promo__describe')}>{item.describe}</p>\n                      <p className={cx('promo__remark')}>\n                        活动时间：{item.remark}\n                      </p>\n                    </div>\n                  </div>\n                </li>\n              ))\n            }\n            {\n              activeIndex === 0 && !!overdue.length &&\n              <li onClick={() => setShowOverdue(!showOverdue)}\n                className={cx('promo__item', 'promo__more')}>\n                <img className={cx('promo__icon-more', { open: showOverdue })}\n                  src={require('@/views/promotions/img/icon_more.png')} alt=\"\"/>\n                <span>更多优惠</span>\n              </li>\n            }\n            {\n              showOverdue ? overdue.map(item => (\n                <li key={item.id} className={cx('promo__item')}>\n                  <p className={cx('promo__title')}>{item.title}</p>\n                  <div className={cx('promo__item-inner')}>\n                    <div className={cx('promo__img-wrapper', 'default-bg-mini')}>\n                      <img className={cx('promo__img', 'overdue')} data-src={item.imgUrl} alt=\"\"/>\n                    </div>\n                    <div className={cx('promo__info')}>\n                      <span className={cx('promo__timer', 'overdue')}>{item.timer}</span>\n                      <p className={cx('promo__describe')}>{item.describe}</p>\n                      <p className={cx('promo__remark')}>\n                        活动时间：{item.remark}\n                      </p>\n                    </div>\n                  </div>\n                </li>\n              )) : null\n            }\n          </ul>\n          {\n            effective.length || overdue.length ? null : <Rotate/>\n          }\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default Promotions\n"],"sourceRoot":""}